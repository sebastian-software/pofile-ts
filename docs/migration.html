<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Migration Guide — pofile-ts</title>
    <meta name="description" content="Migrate from pofile 1.x to pofile-ts." />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="layout">
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <a href="index.html" class="sidebar-logo">
          <img src="logo.svg" alt="pofile-ts" />
          <span>pofile-ts</span>
        </a>

        <nav class="sidebar-nav">
          <div class="sidebar-section">
            <div class="sidebar-section-title">Getting Started</div>
            <a href="index.html" class="sidebar-link">Overview</a>
            <a href="guide.html" class="sidebar-link">Quick Start</a>
            <a href="guide.html#helpers" class="sidebar-link">i18n Helpers</a>
          </div>

          <div class="sidebar-section">
            <div class="sidebar-section-title">Reference</div>
            <a href="format.html" class="sidebar-link">PO File Format</a>
            <a href="api.html" class="sidebar-link">API Reference</a>
            <a href="api.html#options" class="sidebar-link">Options</a>
          </div>

          <div class="sidebar-section">
            <div class="sidebar-section-title">More</div>
            <a href="migration.html" class="sidebar-link active">Migration Guide</a>
            <a
              href="https://github.com/sebastian-software/pofile-ts"
              class="sidebar-link"
              target="_blank"
              rel="noopener"
              >GitHub ↗</a
            >
          </div>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main">
        <button class="mobile-menu-toggle" onclick="toggleMenu()" aria-label="Toggle menu">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="3" y1="12" x2="21" y2="12" />
            <line x1="3" y1="6" x2="21" y2="6" />
            <line x1="3" y1="18" x2="21" y2="18" />
          </svg>
        </button>

        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
          <svg
            class="sun"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="5" />
            <line x1="12" y1="1" x2="12" y2="3" />
            <line x1="12" y1="21" x2="12" y2="23" />
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
            <line x1="1" y1="12" x2="3" y2="12" />
            <line x1="21" y1="12" x2="23" y2="12" />
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
          </svg>
          <svg
            class="moon"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
          </svg>
        </button>

        <div class="container">
          <header class="compact">
            <h1 class="page-title">Migration Guide</h1>
            <p class="page-subtitle">Upgrading from pofile 1.x to pofile-ts.</p>
          </header>

          <!-- Overview -->
          <section>
            <h2>Overview</h2>
            <p>
              pofile-ts is a modernized fork of the original
              <a href="https://github.com/rubenv/pofile" target="_blank" rel="noopener">pofile</a>
              package. The API has been redesigned to use pure functions instead of classes.
            </p>

            <div class="info-box">
              <p>
                <strong>Key changes:</strong> Class-based API → Functional API, callbacks → async,
                and ESM-first with full TypeScript support.
              </p>
            </div>
          </section>

          <!-- Requirements -->
          <section>
            <h2>Requirements</h2>
            <ul>
              <li><strong>Node.js 20+</strong> or modern browsers</li>
              <li><strong>ESM-first</strong> with full TypeScript support</li>
              <li><strong>Named exports only</strong> — no default export</li>
            </ul>
          </section>

          <!-- API Changes -->
          <section>
            <h2>API Changes</h2>

            <h3>Parsing</h3>
            <pre><span class="code-comment">// ❌ Old API (pofile 1.x)</span>
<span class="code-keyword">import</span> PO <span class="code-keyword">from</span> <span class="code-string">"pofile"</span>
<span class="code-keyword">const</span> po = PO.<span class="code-function">parse</span>(content)

<span class="code-comment">// ✅ New API (pofile-ts)</span>
<span class="code-keyword">import</span> { parsePo } <span class="code-keyword">from</span> <span class="code-string">"pofile-ts"</span>
<span class="code-keyword">const</span> po = <span class="code-function">parsePo</span>(content)</pre>

            <h3>Creating Items</h3>
            <pre><span class="code-comment">// ❌ Old API (pofile 1.x)</span>
<span class="code-keyword">const</span> item = <span class="code-keyword">new</span> PO.<span class="code-type">Item</span>()

<span class="code-comment">// ✅ New API (pofile-ts)</span>
<span class="code-keyword">import</span> { createItem } <span class="code-keyword">from</span> <span class="code-string">"pofile-ts"</span>
<span class="code-keyword">const</span> item = <span class="code-function">createItem</span>()</pre>

            <h3>Serialization</h3>
            <pre><span class="code-comment">// ❌ Old API (pofile 1.x)</span>
po.<span class="code-function">toString</span>()

<span class="code-comment">// ✅ New API (pofile-ts)</span>
<span class="code-keyword">import</span> { stringifyPo } <span class="code-keyword">from</span> <span class="code-string">"pofile-ts"</span>
<span class="code-function">stringifyPo</span>(po)</pre>

            <h3>File I/O</h3>
            <p>
              The <code>load()</code> and <code>save()</code> methods have been removed. Use native
              file system APIs instead:
            </p>

            <pre><span class="code-comment">// ❌ Old API (pofile 1.x)</span>
PO.<span class="code-function">load</span>(<span class="code-string">"messages.po"</span>, (err, po) => {
  <span class="code-keyword">if</span> (err) <span class="code-keyword">throw</span> err
  <span class="code-comment">// use po</span>
})

<span class="code-comment">// ✅ New API (pofile-ts)</span>
<span class="code-keyword">import</span> { readFile } <span class="code-keyword">from</span> <span class="code-string">"node:fs/promises"</span>
<span class="code-keyword">import</span> { parsePo } <span class="code-keyword">from</span> <span class="code-string">"pofile-ts"</span>

<span class="code-keyword">const</span> content = <span class="code-keyword">await</span> <span class="code-function">readFile</span>(<span class="code-string">"messages.po"</span>, <span class="code-string">"utf-8"</span>)
<span class="code-keyword">const</span> po = <span class="code-function">parsePo</span>(content)</pre>
          </section>

          <!-- Quick Reference -->
          <section>
            <h2>Quick Reference</h2>

            <table class="api-table">
              <thead>
                <tr>
                  <th>pofile 1.x</th>
                  <th>pofile-ts</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>PO.parse(content)</code></td>
                  <td><code>parsePo(content)</code></td>
                </tr>
                <tr>
                  <td><code>new PO()</code></td>
                  <td><code>createPoFile()</code></td>
                </tr>
                <tr>
                  <td><code>new PO.Item()</code></td>
                  <td><code>createItem()</code></td>
                </tr>
                <tr>
                  <td><code>po.toString()</code></td>
                  <td><code>stringifyPo(po)</code></td>
                </tr>
                <tr>
                  <td><code>item.toString()</code></td>
                  <td><code>stringifyItem(item)</code></td>
                </tr>
                <tr>
                  <td><code>PO.load(path, callback)</code></td>
                  <td>Use <code>fs.readFile</code> + <code>parsePo</code></td>
                </tr>
                <tr>
                  <td><code>po.save(path, callback)</code></td>
                  <td>Use <code>stringifyPo</code> + <code>fs.writeFile</code></td>
                </tr>
              </tbody>
            </table>
          </section>

          <!-- Why Migrate? -->
          <section>
            <h2>Why Migrate?</h2>
            <ul>
              <li><strong>23× faster parsing</strong> — hand-optimized hot paths</li>
              <li><strong>Full TypeScript support</strong> — complete type definitions</li>
              <li><strong>Modern API</strong> — functional, tree-shakeable exports</li>
              <li><strong>Browser support</strong> — no Node.js-specific APIs</li>
              <li><strong>i18n helpers</strong> — catalog conversion, message IDs, and more</li>
              <li><strong>Actively maintained</strong> — regular updates and fixes</li>
            </ul>
          </section>

          <footer>
            <p>
              Released under the
              <a href="https://github.com/sebastian-software/pofile-ts/blob/main/LICENSE"
                >MIT License</a
              >
            </p>
            <p class="credits">
              Maintained by <a href="https://sebastian-software.de/">Sebastian Software</a>
            </p>
          </footer>
        </div>
      </main>
    </div>

    <script>
      function toggleTheme() {
        const html = document.documentElement
        const current = html.getAttribute("data-theme")
        const next = current === "light" ? "dark" : "light"
        html.setAttribute("data-theme", next)
        localStorage.setItem("theme", next)
      }

      function toggleMenu() {
        document.getElementById("sidebar").classList.toggle("open")
      }

      const saved = localStorage.getItem("theme")
      if (saved) {
        document.documentElement.setAttribute("data-theme", saved)
      } else if (window.matchMedia("(prefers-color-scheme: light)").matches) {
        document.documentElement.setAttribute("data-theme", "light")
      }
    </script>
  </body>
</html>
